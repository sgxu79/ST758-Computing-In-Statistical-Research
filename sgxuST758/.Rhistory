norm(matvec,"2")
change = norm(x-x_last,type="2")
change
x
x_last = x
matvec = A%*%x_last
x = (matvec)/norm(matvec,type="2")
x==x_last
norm(matvec,"2")
change = norm(x-x_last,type="2")
change
x_last = x
matvec = A%*%x_last
x = (matvec)/norm(matvec,type="2")
norm(matvec)
change = norm(x-x_last,type="2")
change
x_last = x
matvec = A%*%x_last
x = (matvec)/norm(matvec,type="2")
change = norm(x-x_last,type="2")
change
(t(x)%*%D%*%x)/(t(x)%*%x)
x = as.matrix(x)
(t(x)%*%D%*%x)/(t(x)%*%x)
(t(x)%*%A%*%x)/(t(x)%*%x)
A = as.martix(A)
A = as.matrix(A)
eig = eigen(A)$values
max = round(eig[which.max(abs(eig))],3)
max
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.1*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
A = as.matrix(A)
x = matrix(rnorm(n),nrow=n)
eg = power_method_dense(A,x,1e6,1e-3)
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.1*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
x_last = x
matvec = A%*%x_last
x = (matvec)/norm(matvec,type="2")
change = norm(x-x_last,type="2")
x_last = x
matvec = A%*%x_last
x = (matvec)/norm(matvec,type="2")
change = norm(x-x_last,type="2")
eg=as.matrix(x)
A = as.matrix(A)
(t(eg)%*%A%*%eg)/(t(eg)%*%eg)
eig = eigen(A)$values
max = round(eig[which.max(abs(eig))],3)
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.5*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e6,1e-3)
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.5*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.25*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e6,1e-3)
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.25*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e2,1e-3)
rm(list=ls())
set.seed(12345)
n <- 5
nnz <- 2
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
as.matrix(A)
library(sgxuST758)
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e2,1e-3)
library(sgxuST758)
eg = power_method_sparse(A,x,1e2,1e-3)
rm(list=ls())
set.seed(12345)
n <- 5
nnz <- 2
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
x_last = x
x_last
matvec = A%*%x_last
matvec
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
rm(list=ls())
set.seed(12345)
n <- 5
nnz <- 2
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
eigen(as.matrix(A))
rm(list=ls())
set.seed(12345)
n <- 5
nnz <- 2
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eigen(as.matrix(A))
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 4
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
eigen(as.matrix(A))
x_last = x
x_last
x = matrix(rnorm(n),nrow=n)
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 4
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
A%*%x
norm(matcev,"2")
norm(matvec,"2")
norm(matvec,"2")*x
eigen(as.matrix(A))
matvec
matvec/2
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
matvec/2
matnorm(matvec,"2")
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
change = norm(x-x_last,type="2")
change
x_last = x
x_last
matvec = A%*%x_last
matvec
norm(matvec,"2")
x = (matvec)/norm(matvec,type="2")
x
norm(x)
norm(x,2)
norm(x,"2")
x%*%x_last
x
x_last
x%*%t(x_last)
t(x)%*%x_last
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 5
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
A
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 10
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
a
a
A
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 30
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 10
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
A
eigen(as.matrix(A))
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 8
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
eigen(as.matrix(A))
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 5
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
eigen(as.matrix(A))
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 6
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
eigen(as.matrix(A))
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 4
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
eigen(as.matrix(A))
A
rm(list=ls())
set.seed(12345)
n <- 10
nnz <- 6
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eigen(as.matrix(A))
eg = power_method_sparse(A,x,1e2,1e-3)
(t(eg)%*%D%*%eg)/(t(eg)%*%eg)
eg=as.matrix(eg)
(t(eg)%*%D%*%eg)/(t(eg)%*%eg)
(t(eg)%*%A%*%eg)/(t(eg)%*%eg)
eigen(as.matrix(A))
library(sgxuST758)
library(Matrix)
library(knitr)
library(Matrix)
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.6*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e6,1e-3)
library(sgxuST758)
library(sgxuST758)
library(Matrix)
library(knitr)
library(Matrix)
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.6*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e6,1e-3)
library(Matrix)
set.seed(12345)
n <- 100
nnz <- 55
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e6,1e-3)
eig = eigen(A)$values
eig
max = round(eig[which.max(abs(eig))],3)
eg = as.matrix(eg)
(t(eg)%*%A%*%eg)/(t(eg)%*%eg)
max = round(eig[which.max(abs(eig))],4)
rm(list=ls())
set.seed(12345)
n <- 1000
nnz <- 600
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e6,1e-3)
eig = eigen(A)$values
max = round(eig[which.max(abs(eig))],4)
eig
library(Matrix)
rm(list=ls())
set.seed(12345)
n <- 1000
nnz <- 800
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
eig = eigen(A)$values
eig
library(Matrix)
rm(list=ls())
set.seed(12345)
n <- 1000
ix <- sample(1:n, size = nnz, replace = FALSE)
nnz <- 1000
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
eig = eigen(A)$values
eig
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e6,1e-3)
eg = as.matrix(eg)
(t(eg)%*%A%*%eg)/(t(eg)%*%eg)
library(Matrix)
rm(list=ls())
set.seed(12345)
n <- 1e3
nnz <- 0.1*n
ix <- sample(1:n, size = nnz, replace = FALSE)
A <- Matrix(0, nrow=n, ncol=n, sparse=TRUE)
A[ix] <- rnorm(nnz)
A <- A + t(A)
A[1,1] <- 10
x = matrix(rnorm(n),nrow=n)
eg = power_method_sparse(A,x,1e6,1e-3)
eg = as.matrix(eg)
A = as.matrix(A)
sp_ev_a=(t(eg)%*%A%*%eg)/(t(eg)%*%eg)
eig = eigen(A)$values
r_sp_ev_a = round(eig[which.max(abs(eig))],4)
sp_ev_a
